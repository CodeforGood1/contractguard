# ContractGuard — Secrets Detection Rules

- id: SEC001
  name: secrets_detected
  analyzer: secrets
  severity: block
  description: "Hardcoded secrets found in source code — immediate rotation required."
  matcher: "secret_count > 0"
  suggestion: "Remove all secrets from code. Use environment variables, a .env file (in .gitignore), or a secrets vault (AWS Secrets Manager, HashiCorp Vault)."
  attack_vector: "Attacker clones public/leaked repo → extracts credentials → compromises infrastructure."
  cwe: "CWE-798"

- id: SEC002
  name: aws_credentials
  analyzer: secrets
  severity: block
  description: "AWS access key detected — cloud infrastructure at risk."
  matcher: "has_aws_key == true"
  suggestion: "Immediately rotate the AWS key in IAM console. Use IAM roles or AWS SSO instead of long-lived keys."
  attack_vector: "Stolen AWS keys → crypto mining, data exfiltration, S3 bucket takeover, $100k+ cloud bills."
  cwe: "CWE-798"

- id: SEC003
  name: private_key_exposed
  analyzer: secrets
  severity: block
  description: "Private key (RSA/SSH/EC) found in source — server compromise possible."
  matcher: "has_private_key == true"
  suggestion: "Regenerate the key pair immediately. Never store private keys in repositories."
  attack_vector: "Extracted private key → SSH into servers, decrypt TLS traffic, impersonate services."
  cwe: "CWE-321"

- id: SEC004
  name: database_url_exposed
  analyzer: secrets
  severity: block
  description: "Database connection string with credentials exposed."
  matcher: "has_database_url == true"
  suggestion: "Move DB credentials to environment variables. Use connection pooling with IAM auth."
  attack_vector: "Database URL → direct data access → full data breach, ransomware."
  cwe: "CWE-200"

- id: SEC005
  name: jwt_token_leaked
  analyzer: secrets
  severity: critical
  description: "JWT token found hardcoded — session hijacking possible."
  matcher: "has_jwt == true"
  suggestion: "Revoke the token. Ensure tokens are generated dynamically and have short expiry times."
  attack_vector: "Stolen JWT → impersonate any user → unauthorized access to all resources."
  cwe: "CWE-522"
