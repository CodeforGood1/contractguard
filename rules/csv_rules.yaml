# ContractGuard — CSV Data Quality Rules

- id: CSV001
  name: mixed_type_columns
  analyzer: csv
  severity: warning
  description: "CSV columns have mixed data types — will cause ETL pipeline failures."
  matcher: "mixed_type_columns > 0"
  suggestion: "Enforce column types at ingestion. Add schema validation to your data pipeline."
  cwe: "CWE-20"

- id: CSV002
  name: inconsistent_column_count
  analyzer: csv
  severity: critical
  description: "Rows have different column counts — corrupted or malformed CSV."
  matcher: "inconsistent_column_count == true"
  suggestion: "Fix the source data export. Add column count validation to your ingestion pipeline."

- id: CSV003
  name: high_null_rate
  analyzer: csv
  severity: warning
  description: "Columns with >50% null values detected — data quality issue."
  matcher: "null_heavy_columns > 0"
  suggestion: "Investigate why data is missing. Set default values or remove unused columns."

- id: CSV004
  name: duplicate_rows
  analyzer: csv
  severity: warning
  description: "Duplicate rows detected — may indicate ETL bugs or missing deduplication."
  matcher: "duplicate_rows > 0"
  suggestion: "Add deduplication to your pipeline. Check for missing primary key constraints."

- id: CSV005
  name: encoding_issues
  analyzer: csv
  severity: critical
  description: "File encoding issues detected — data corruption risk."
  matcher: "has_encoding_issues == true"
  suggestion: "Standardize on UTF-8 encoding. Fix the data export to use consistent encoding."
